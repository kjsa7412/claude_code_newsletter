<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.prompthub.api.usage.UsageMapper">

    <!-- ================================================================
         ResultMap: usage_events 테이블 매핑
         ================================================================ -->
    <resultMap id="usageEventResultMap" type="com.prompthub.api.usage.UsageEvent">
        <id     property="id"         column="id"          javaType="java.util.UUID"/>
        <result property="templateId" column="template_id" javaType="java.util.UUID"/>
        <result property="userId"     column="user_id"     javaType="java.util.UUID"/>
        <result property="usedAt"     column="used_at"     javaType="java.time.OffsetDateTime"/>
    </resultMap>

    <!-- ================================================================
         insert: 사용 이벤트 기록
         ================================================================ -->
    <insert id="insert" parameterType="com.prompthub.api.usage.UsageEvent">
        INSERT INTO usage_events (
            id,
            template_id,
            user_id,
            used_at
        ) VALUES (
            #{id}::uuid,
            #{templateId}::uuid,
            #{userId}::uuid,
            #{usedAt}
        )
    </insert>

</mapper>
